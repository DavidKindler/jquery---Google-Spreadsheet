(function(t){t.fn.GoogleSpreadsheet=function(q,u){function w(c,b){for(var k in c)if(c[k]==b)return!0}defaults={GS_Table_class:"GS_Table",table_head:void 0,table_template:void 0,filters:!0,subfilters:{},alternateRowClassNames:[]};Array.prototype.unique=function(){var c={},b,k=this.length,f=[];for(b=0;b<k;b+=1)c[this[b]]=this[b];for(b in c)f.push(c[b]);return f};var c=$.extend({},defaults,q),n=c.alternateRowClassNames[0]||"",r=c.alternateRowClassNames[1]||"";return this.each(function(){var v=$(this),
b,k,f=function(a,c){$(a,b).each(function(){0>$(this).text().search(RegExp(c,"i"))?$(this).attr("data-value",0):$(this).attr("data-value",1);sum=0;sum+=parseInt($(this).attr("data-value"));$(this).siblings().each(function(){sum+=parseInt($(this).attr("data-value"))});sum<k?$(this).parent(this).hide():$(this).parent(this).show()})},q=function(a){$("#Col"+a,b).empty().wrapInner('<input type="text" id="filterText'+a+'" class="filterText">');$("#filterText"+a,b).keyup(function(){f("tbody>tr>td:nth-child("+
a+")",$(this).val(),s)})},y=function(a){$("#Col"+a,b).empty().wrapInner('<select id="filterText'+a+'" class="filterText">');x(a);$("#filterText"+a,b).change(function(){selectedTrack=$(this).val();if(c.subfilters[a]){subfilter=c.subfilters[a];var d=$("#filterText"+subfilter,b);if(selectedTrack.length){var h=[],e=[];i=parseInt(a)-1;j=parseInt(subfilter)-1;$("tbody>tr").each(function(){$(this).find("td:eq("+i+")").text()==selectedTrack&&(str=$(this).find("td:eq("+j+")").attr("data-value",1).text(),h.push($.trim(str)))});
var m=h.unique();m.unshift("");$.each(m,function(a,b){e.push('<option value="'+b+'">'+b+"</option>")});d.empty().append(e.join(""))}else $("tbody tr td:nth-child("+a+")").attr("data-value",1),$("tbody tr td:nth-child("+subfilter+")").attr("data-value",1),d.empty().append("<option ></option>")}f("tbody tr td:nth-child("+a+")",$(this).val(),s)})},x=function(a){var d=[],h=[];if(w(c.subfilters,a))$("#filterText"+a,b).empty().append("<option ></option>");else{$("tbody>tr",b).each(function(){str=$.trim($(this).find("td:nth-child("+
a+")",this).text());str.length&&d.push(str)});var e=d.unique();e.unshift("");$.each(e,function(b,a){h.push('<option value="'+a+'">'+a+"</option>")});$("#filterText"+a,b).empty().append(h.join(""))}},s=function(a){c.alternateRowClassNames&&c.alternateRowClassNames.length&&($("tbody>tr:visible:even",a).removeClass(r).removeClass(n).addClass(n),$("tbody tr:visible:odd",a).removeClass(r).removeClass(n).addClass(r))};c.key?t.getJSON("http://spreadsheets.google.com/feeds/cells/"+c.key+"/od6/public/basic?alt=json-in-script&callback=?",
function(a){var d=0,h=0,e=/.*\/R(\d*)C(\d*)/,m=[],f=a.feed.entry.length;for(l=0;l<f;l++){var o=a.feed.entry[l],g=e.exec(o.id.$t),p,n;null!=g&&(p=parseInt(g[1]),n=parseInt(g[2]));"undefined"==typeof m[p]&&(m[p]=[]);m[p][n]=o.content.$t;d=Math.max(d,p);h=Math.max(h,n)}a=d;d=[];e=[];f=[];rowCount=0;for(o=1;o<=a;o++){rowCount++;for(g=1;g<=h;g++)f[g]="undefined"!=typeof m[o][g]?m[o][g]:"",(!c.table_template||!c.table_head)&&e.push("<td>"+f[g]+"</td>");c.table_template&&c.table_head?1==rowCount?d.push(c.table_head):
d.push(c.table_template(f)):1==rowCount?d.push("<thead><tr>"+e.join("")+"</tr></thead>"):d.push('<tr style="display:table-row;">'+e.join("")+"</tr>");e=[]}$("<table/>",{html:d.join("")}).attr({"class":c.GS_Table_class}).appendTo(v);b=$(v).find("table").first();if(c.filters){k=b.find("tr")[0].cells.length;$("thead",b).append('<tr class="filterColumns" />');for(i=1;i<=k;i++)$(".filterColumns",b).append('<td id="Col'+i+'">');for(i=0;i<=k;i++)"none"!=$("thead th:eq("+i+")",b).attr("filter-type")&&("ddl"==
$("thead th:eq("+i+")",b).attr("filter-type")?y(i+1):q(i+1));$("tbody tr td",b).attr("data-value",1)}s(b);"function"==typeof u&&u.call(this)}):alert("No Google Spreadsheet key")})}})(jQuery);